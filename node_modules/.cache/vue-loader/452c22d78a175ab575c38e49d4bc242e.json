{"remainingRequest":"/home/jlawrence/10x/apps/OmsVue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jlawrence/10x/apps/OmsVue/src/components/Map/LocationPicker.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jlawrence/10x/apps/OmsVue/src/components/Map/LocationPicker.vue","mtime":1585672524041},{"path":"/home/jlawrence/10x/apps/OmsVue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jlawrence/10x/apps/OmsVue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/jlawrence/10x/apps/OmsVue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jlawrence/10x/apps/OmsVue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { LMap, LTileLayer, LMarker, LPopup } from 'vue2-leaflet'\nimport VueBootstrapTypeahead from 'vue-bootstrap-typeahead'\nimport _ from 'lodash'\nconst { NominatimJS } = require('@owsas/nominatim-js')\n\nexport default {\n    name: 'location-picker',\n    components: { LMap, LTileLayer, LMarker, LPopup, VueBootstrapTypeahead },\n    props: {\n        value: {\n            name: 'value',\n            type: Object,\n            default: () => L.latLng(14, -78),\n        },\n    },\n    data() {\n        return {\n            model: {\n                id: 0,\n                name: '',\n                location: '',\n                lat: '',\n                lon: '',\n            },\n            updating: false,\n            zoom: 13,\n            url: 'http://{s}.tile.osm.org/{z}/{x}/{y}.png',\n            attribution:\n                '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n            popupData: \"Hello I'm a Popup\",\n            query: '',\n            addresses: [],\n        }\n    },\n    mounted() {\n        // console.log(this.$refs)\n        // console.log(this.$refs.point)\n        //this.$refs.marker.on('dragend', this.setMarkerPos)\n        // https://stackoverflow.com/questions/54355375/vue-js-refs-are-undefined-even-though-this-refs-shows-theyre-there\n        // this.$nextTick(() => {\n        //     let self = this\n        //     console.log(self.$refs) // Shows the mapRef object reference\n        //     console.log(self.$refs.marker) // returns undefined ???\n        //     this.$refs.marker.on('dragend', this.setMarkerPos)\n        //     // L.marker(this.center)\n        //     //     .addTo(this.$refs.map)\n        //     //     .on('dragend', this.setMarkerPos)\n        // })\n    },\n    methods: {\n        setMarkerPos(pos) {\n            //console.log('new pos', this.$refs.marker.mapObject.getLatLng())\n            this.$emit('input', this.$refs.marker.mapObject.getLatLng())\n        },\n        itemSelected(item) {\n            this.$emit('input', L.latLng(item.lat, item.lon))\n        },\n    },\n    watch: {\n        query: _.debounce(function() {\n            NominatimJS.search({\n                q: this.query,\n            })\n                .then(results => {\n                    // do something with results\n                    this.addresses = results\n                })\n                .catch(error => {\n                    // error ocurred\n                })\n        }, 500),\n    },\n}\n",{"version":3,"sources":["LocationPicker.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LocationPicker.vue","sourceRoot":"src/components/Map","sourcesContent":["<template>\n    <div class=\"form-group has-label\">\n        <label class=\"form-control-label\">Location</label>\n        <vue-bootstrap-typeahead\n            class=\"autocomplete\"\n            style=\"z-index:10000; border-radius:0;\"\n            v-model=\"query\"\n            placeholder=\"Search for a location\"\n            :serializer=\"t => t.display_name\"\n            :data=\"addresses\"\n            @hit=\"itemSelected\"\n        />\n        <l-map :zoom=\"zoom\" :center=\"value\" ref=\"map\" style=\"height:400px\">\n            <l-tile-layer :url=\"url\" :attribution=\"attribution\"></l-tile-layer>\n            <l-marker :lat-lng=\"value\" :draggable=\"true\" @moveend=\"setMarkerPos\" ref=\"marker\">\n                <l-popup :content=\"popupData\" :autoClose=\"false\" />\n            </l-marker>\n        </l-map>\n    </div>\n</template>\n\n<script>\nimport { LMap, LTileLayer, LMarker, LPopup } from 'vue2-leaflet'\nimport VueBootstrapTypeahead from 'vue-bootstrap-typeahead'\nimport _ from 'lodash'\nconst { NominatimJS } = require('@owsas/nominatim-js')\n\nexport default {\n    name: 'location-picker',\n    components: { LMap, LTileLayer, LMarker, LPopup, VueBootstrapTypeahead },\n    props: {\n        value: {\n            name: 'value',\n            type: Object,\n            default: () => L.latLng(14, -78),\n        },\n    },\n    data() {\n        return {\n            model: {\n                id: 0,\n                name: '',\n                location: '',\n                lat: '',\n                lon: '',\n            },\n            updating: false,\n            zoom: 13,\n            url: 'http://{s}.tile.osm.org/{z}/{x}/{y}.png',\n            attribution:\n                '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n            popupData: \"Hello I'm a Popup\",\n            query: '',\n            addresses: [],\n        }\n    },\n    mounted() {\n        // console.log(this.$refs)\n        // console.log(this.$refs.point)\n        //this.$refs.marker.on('dragend', this.setMarkerPos)\n        // https://stackoverflow.com/questions/54355375/vue-js-refs-are-undefined-even-though-this-refs-shows-theyre-there\n        // this.$nextTick(() => {\n        //     let self = this\n        //     console.log(self.$refs) // Shows the mapRef object reference\n        //     console.log(self.$refs.marker) // returns undefined ???\n        //     this.$refs.marker.on('dragend', this.setMarkerPos)\n        //     // L.marker(this.center)\n        //     //     .addTo(this.$refs.map)\n        //     //     .on('dragend', this.setMarkerPos)\n        // })\n    },\n    methods: {\n        setMarkerPos(pos) {\n            //console.log('new pos', this.$refs.marker.mapObject.getLatLng())\n            this.$emit('input', this.$refs.marker.mapObject.getLatLng())\n        },\n        itemSelected(item) {\n            this.$emit('input', L.latLng(item.lat, item.lon))\n        },\n    },\n    watch: {\n        query: _.debounce(function() {\n            NominatimJS.search({\n                q: this.query,\n            })\n                .then(results => {\n                    // do something with results\n                    this.addresses = results\n                })\n                .catch(error => {\n                    // error ocurred\n                })\n        }, 500),\n    },\n}\n</script>\n\n<style>\n.autocomplete input {\n    border-radius: 0;\n}\n</style>"]}]}